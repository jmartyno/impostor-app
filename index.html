<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IMPOSTOR</title>
<link rel="manifest" href="manifest.json">

<style>
    body { font-family: Arial; text-align:center; padding:20px; background:#f0f8ff; }
    button { padding:15px; font-size:18px; margin-top:20px; width:80%; border-radius:12px; }
    #game { display:none; }
    #wordBox { font-size:32px; margin:30px 0; font-weight:bold; }
    #pinBox { display:none; }
</style>

<script>
// =============================
// LISTAS TEMÃTICAS
// =============================
const listas = {
    animales: [
        "PERRO","GATO","ELEFANTE","LEON","TIBURON","PINGÃœINO","CABALLO","JIRAFA","BABOSA","ESCORPION","RATA"
    ],
    objetos: [
        "TECLADO","TELEVISOR","VENTILADOR","RELOJ","MOCHILA","TIJERAS","BOTELLA","LINTERNA","NEVERA","BOTELLA"
    ],
    profesiones: [
        "MEDICO","PILOTO","ABOGADO","CARPINTERO","MECANICO","PROFESOR","ENFERMERO","CAMARERO","INGENIERO","MUSICO"
    ],
    acciones: [
        "CORRER","SALTAR","BOSTEZAR","ESCRIBIR","BESAR","SUSURRAR","NADAR","SALUDAR"
    ],
    comida: [
        "PIZZA","HAMBURGUESA","SUSHI","HELADO","PAELLA","TORTILLA","CHOCOLATE","PASTA"
    ],
    marcas: [
        "NIKE","ADIDAS","ZARA","APPLE","TESLA","GUCCI","PRADA","SAMSUNG","BMW",
        "MERCEDES","ROLEX","RAYBAN","CHANEL","COCACOLA","AMAZON","SPOTIFY","AUDI",
        "LOEWE","BALENCIAGA","SAGAZMOBILITY","LATRAJERIA","SAGAZ","DUREX","PORSCHE"
    ],
    personajes: [
        "PEDRO SANCHEZ","PABLO IGLESIAS","ERREJON","ABASCAL","ALVISE","RAJOY","AZNAR",
        "DAVID BISBAL","JUAN CARLOS I","FELIPE VI","YOLANDA DIAZ","MÂªJESUS MONTERO","FRANCO"
    ],    
    adultos: [
        "SEXO","BORRACHO","RESACA","CORNUDO","ORGASMO",
        "CULO","EMPALMADO","PUTICLUB","69","DESEO",
        "CONDÃ“N","PORNO","FETICHE","TRÃO","GIGOLO",
        "VICIO","PASIÃ“N","TETAS","NINFÃ“MANA","PUTA","COÃ‘O","POLLA"
    ]
};

let roles = [];
let current = 0;
let adultosDesbloqueado = false;  
const PIN_ADULTOS = "1234"; // CAMBIA AQUÃ EL PIN

// =============================
// DESBLOQUEO TEMÃTICA ADULTOS
// =============================
function checkAdultos() {
    if (document.getElementById("tema").value === "adultos" && !adultosDesbloqueado) {
        document.getElementById("pinBox").style.display = "block";
    }
}

function validarPIN() {
    const pin = document.getElementById("pinInput").value;
    if (pin === PIN_ADULTOS) {
        adultosDesbloqueado = true;
        document.getElementById("pinBox").style.display = "none";
        alert("TemÃ¡tica ADULTOS desbloqueada");
    } else {
        alert("PIN incorrecto");
        document.getElementById("tema").value = "animales";
    }
}

// =============================
// INICIAR JUEGO
// =============================
function startGame() {
    let p = parseInt(document.getElementById("players").value);
    let i = parseInt(document.getElementById("impostors").value);
    let tema = document.getElementById("tema").value;

    if (!p || !i) { alert("Rellena participantes e impostores"); return; }
    if (i >= p) { alert("Impostores debe ser menor que participantes"); return; }

    // Palabra automÃ¡tica segÃºn temÃ¡tica
    const lista = listas[tema];
    const w = lista[Math.floor(Math.random() * lista.length)];

    roles = Array(p).fill(w);
    for (let x = 0; x < i; x++) roles[x] = "IMPOSTOR";

    roles.sort(() => Math.random() - 0.5);

    document.getElementById("setup").style.display = "none";
    document.getElementById("game").style.display = "block";

    updatePlayer();
}

function updatePlayer() {
    document.getElementById("playerNum").innerText =
        "Participante " + (current + 1);
    document.getElementById("wordBox").innerText = "";
    document.getElementById("showBtn").style.display = "inline-block";
    document.getElementById("nextBtn").style.display = "none";
}

function showWord() {
    const beep = new Audio("https://actions.google.com/sounds/v1/cartoon/boing.ogg");
    beep.play();

    document.getElementById("wordBox").innerText = roles[current];
    document.getElementById("showBtn").style.display = "none";
    document.getElementById("nextBtn").style.display = "inline-block";
}

function nextPlayer() {
    current++;

    // Si era el Ãºltimo jugador
    if (current >= roles.length) {

        // Ocultar la palabra ANTES de mostrar el mensaje
        document.getElementById("wordBox").innerText = "";

        // TambiÃ©n ocultamos los botones por seguridad
        document.getElementById("showBtn").style.display = "none";
        document.getElementById("nextBtn").style.display = "none";

        alert("Todos han visto su palabra. Â¡A jugar!");

        // Recargar la app limpia
        location.reload();
        return;
    }

    updatePlayer();
}


// PWA
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
}
</script>
</head>

<body>

<h2>IMPOSTOR</h2>

<div id="setup">

    <label>NÂº Participantes:</label><br>
    <input id="players" type="number"><br><br>

    <label>NÂº Impostores:</label><br>
    <input id="impostors" type="number"><br><br>

    <label>TemÃ¡tica:</label><br>
    <select id="tema" onchange="checkAdultos()">
        <option value="animales">Animales</option>
        <option value="objetos">Objetos</option>
        <option value="profesiones">Profesiones</option>
        <option value="acciones">Acciones</option>
        <option value="comida">Comida</option>
        <option value="marcas">Marcas</option>
        <option value="personajes">Personajes</option>
        <option value="adultos">Adultos ðŸ”’</option>
    </select>
    <br><br>

    <div id="pinBox">
        <label>Introduce PIN:</label><br>
        <input id="pinInput" type="password">
        <button onclick="validarPIN()">OK</button>
        <br><br>
    </div>

    <button onclick="startGame()">Comenzar</button>
</div>

<div id="game">
    <h3 id="playerNum"></h3>
    <div id="wordBox"></div>

    <button id="showBtn" onclick="showWord()">Mostrar palabra</button>
    <button id="nextBtn" onclick="nextPlayer()" style="display:none;">Pasar mÃ³vil</button>
</div>

</body>
</html>
